<script>
    /* Comprobamos que el origen sea el autorizado */
    if (window.opener.location.host === window.location.host) {
        /* Enviamos un mensaje de vuelta a la ventana original */
        window.opener.postMessage(document.location.hash);
    }
    /* Aunque la ventana original nos cerrar√°, nosotros lo haremos antes */
    window.close();
</script>